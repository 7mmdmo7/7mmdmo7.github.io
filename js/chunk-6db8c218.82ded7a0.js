(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6db8c218"],{"0811":function(t,e,r){"use strict";r.r(e);var s=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"container p-4"},[r("h2",[t._v("Users")]),r("div",{staticClass:"text-end mb-2"},[r("button",{staticClass:"btn btn-outline-danger ms-1",on:{click:function(e){return t.delete_users()}}},[r("i",{staticClass:"bi-recycle me-1"})])]),r("div",{staticClass:"card card-body p-2"},[t.errorMessage?r("div",{staticClass:"text-center text-warning"},[t._v(" "+t._s(t.errorMessage)+" "),r("hr"),r("button",{staticClass:"btn btn-block btn-warning",attrs:{type:"button"},on:{click:t.tray_again}},[t._v("Réessayer")])]):r("div",[r("table",{staticClass:"table table-striped table-index"},[t._m(0),r("tbody",t._l(t.users,(function(e){return r("tr",{key:e.id},[r("th",{staticClass:"align-middle td-title text-primary",attrs:{scope:"row"},on:{click:function(r){return t.show_user(e)}}},[t._v(t._s(e.name))]),r("td",{staticClass:"align-middle"},[t._v(t._s(e.family))]),r("td",{staticClass:"align-middle"},[t._v(t._s(e.type))]),r("td",{staticClass:"align-middle"},[r("a",{attrs:{href:"tel:"+e.phone}},[t._v(t._s(e.phone))])]),r("td",{staticClass:"align-middle"},[t._v(t._s(t._f("moment")(e.created_at)))]),r("td",{staticClass:"align-middle text-center"},[r("button",{staticClass:"btn btn-primary btn-sm me-1",on:{click:function(r){return t.show_user(e)}}},[r("i",{staticClass:"bi-eye"})]),r("button",{staticClass:"btn btn-warning btn-sm me-1",on:{click:function(r){return t.update_user(e)}}},[r("i",{staticClass:"bi-pencil-square"})]),r("button",{staticClass:"btn btn-danger btn-sm",on:{click:function(r){return t.delete_user(e)}}},[r("i",{staticClass:"bi-trash"})])])])})),0)])]),t.isLoading?r("loading-compoenent"):t._e()],1),t.errorMessage||t.isLoading?t._e():r("div",{staticClass:"my-4 py-1 text-center"},[r("button",{staticClass:"btn btn-outline-primary",attrs:{type:"button"},on:{click:t.smart_load_users}},[t._v(" Voir plus "),r("i",{staticClass:"bi-chevron-double-right ms-1"})])])])},n=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("thead",[r("tr",[r("th",{attrs:{scope:"col"}},[t._v("Prénom")]),r("th",{attrs:{scope:"col"}},[t._v("Nom")]),r("th",{attrs:{scope:"col"}},[t._v("Role")]),r("th",{attrs:{scope:"col"}},[t._v("Téléphone")]),r("th",{attrs:{scope:"col"}},[t._v("Created at")]),r("th",{staticClass:"text-center",attrs:{scope:"col"}},[t._v("Actions")])])])}],a=r("5530"),i=(r("a434"),r("7db0"),r("159b"),r("f9f2")),o={components:{},data:function(){return{users:[],first_created_at:null,last_created_at:null,limit:20,errorMessage:null,isLoading:!1}},computed:{total:function(){return this.users.length}},created:function(){this.smart_load_users()},methods:{tray_again:function(){this.isLoading=!1,this.errorMessage=null},show_user:function(t){this.$router.push({name:"show-profile",params:{phone:t.phone}})},update_user:function(t){this.$router.push({name:"edit-profile",params:{phone:t.phone}})},delete_user:function(t){var e=this;window.confirm("Do you really want to delete?")&&(this.isLoading=!0,this.errorMessage=null,i["d"].collection("users").doc(t.id).delete().then((function(){e.isLoading=!1,e.errorMessage=null,console.log("User successfully deleted!"),e.users.splice(e.users.indexOf(t),1)})).catch((function(t){e.isLoading=!1,e.errorMessage=null,console.log("error",t)})))},delete_user_by_id:function(t){var e=this.users.find((function(e){return e.id===t}));e&&this.users.splice(this.users.indexOf(e),1)},add_user:function(t){this.delete_user_by_id(t.id),this.users.push(t),this.smart_load_update_created_at(t)},load_user:function(t){var e=this;this.isLoading=!0,this.errorMessage=null,i["d"].collection("users").doc(t).get().then((function(t){e.isLoading=!1,e.errorMessage=null,e.add_user(Object(a["a"])({id:t.id},t.data()))})).catch((function(t){e.isLoading=!1,e.errorMessage=t,console.log("error",t)}))},smart_load_users:function(){var t=this;this.isLoading=!0,this.errorMessage=null;var e=i["d"].collection("users");e=e.orderBy("created_at","desc"),this.last_created_at&&(e=e.where("created_at","<",this.last_created_at)),e.limit(this.limit).get().then((function(e){t.isLoading=!1,t.errorMessage=null,console.log("Users successfully loaded!"),e.docs.forEach((function(e){t.add_user(Object(a["a"])({id:e.id},e.data()))})),t.smart_load_new_users()})).catch((function(e){t.isLoading=!1,t.errorMessage=null,console.log("error",e)}))},smart_load_new_users:function(){var t=this;this.isLoading=!0,this.errorMessage=null;var e=i["d"].collection("users");e=e.orderBy("created_at","desc"),this.first_created_at&&(e=e.where("created_at",">",this.first_created_at)),e.limit(this.limit).get().then((function(e){t.isLoading=!1,t.errorMessage=null,console.log("Users successfully loaded!"),e.docs.forEach((function(e){t.add_user(Object(a["a"])({id:e.id},e.data()))}))})).catch((function(e){t.isLoading=!1,t.errorMessage=null,console.log("error",e)}))},smart_load_update_created_at:function(t){var e=t.created_at;e&&((!this.last_created_at||this.last_created_at.toDate()>e.toDate())&&(this.last_created_at=e),(!this.first_created_at||this.first_created_at.toDate()<e.toDate())&&(this.first_created_at=e))},delete_users:function(){var t=this;window.confirm("Do you really want to delete all shown users?")&&this.users.forEach((function(e){i["d"].collection("users").doc(e.id).delete().then((function(){t.users.splice(t.users.indexOf(e),1)})).catch((function(e){t.isLoading=!1,t.errorMessage=null,console.log("error",e)}))}))}}},c=o,l=(r("f46c"),r("2877")),u=Object(l["a"])(c,s,n,!1,null,"7551b3bc",null);e["default"]=u.exports},"159b":function(t,e,r){var s=r("da84"),n=r("fdbc"),a=r("785a"),i=r("17c2"),o=r("9112"),c=function(t){if(t&&t.forEach!==i)try{o(t,"forEach",i)}catch(e){t.forEach=i}};for(var l in n)n[l]&&c(s[l]&&s[l].prototype);c(a)},"17c2":function(t,e,r){"use strict";var s=r("b727").forEach,n=r("a640"),a=n("forEach");t.exports=a?[].forEach:function(t){return s(this,t,arguments.length>1?arguments[1]:void 0)}},"3a61":function(t,e,r){},5530:function(t,e,r){"use strict";r.d(e,"a",(function(){return a}));r("b64b"),r("a4d3"),r("4de4"),r("e439"),r("159b"),r("dbb4");function s(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function n(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,s)}return r}function a(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?n(Object(r),!0).forEach((function(e){s(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}},"7db0":function(t,e,r){"use strict";var s=r("23e7"),n=r("b727").find,a=r("44d2"),i="find",o=!0;i in[]&&Array(1)[i]((function(){o=!1})),s({target:"Array",proto:!0,forced:o},{find:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}}),a(i)},a434:function(t,e,r){"use strict";var s=r("23e7"),n=r("23cb"),a=r("5926"),i=r("07fa"),o=r("7b0b"),c=r("65f0"),l=r("8418"),u=r("1dde"),d=u("splice"),f=Math.max,h=Math.min,_=9007199254740991,b="Maximum allowed length exceeded";s({target:"Array",proto:!0,forced:!d},{splice:function(t,e){var r,s,u,d,g,p,m=o(this),v=i(m),y=n(t,v),w=arguments.length;if(0===w?r=s=0:1===w?(r=0,s=v-y):(r=w-2,s=h(f(a(e),0),v-y)),v+r-s>_)throw TypeError(b);for(u=c(m,s),d=0;d<s;d++)g=y+d,g in m&&l(u,d,m[g]);if(u.length=s,r<s){for(d=y;d<v-s;d++)g=d+s,p=d+r,g in m?m[p]=m[g]:delete m[p];for(d=v;d>v-s+r;d--)delete m[d-1]}else if(r>s)for(d=v-s;d>y;d--)g=d+s-1,p=d+r-1,g in m?m[p]=m[g]:delete m[p];for(d=0;d<r;d++)m[d+y]=arguments[d+2];return m.length=v-s+r,u}})},a640:function(t,e,r){"use strict";var s=r("d039");t.exports=function(t,e){var r=[][t];return!!r&&s((function(){r.call(null,e||function(){throw 1},1)}))}},b64b:function(t,e,r){var s=r("23e7"),n=r("7b0b"),a=r("df75"),i=r("d039"),o=i((function(){a(1)}));s({target:"Object",stat:!0,forced:o},{keys:function(t){return a(n(t))}})},dbb4:function(t,e,r){var s=r("23e7"),n=r("83ab"),a=r("56ef"),i=r("fc6a"),o=r("06cf"),c=r("8418");s({target:"Object",stat:!0,sham:!n},{getOwnPropertyDescriptors:function(t){var e,r,s=i(t),n=o.f,l=a(s),u={},d=0;while(l.length>d)r=n(s,e=l[d++]),void 0!==r&&c(u,e,r);return u}})},e439:function(t,e,r){var s=r("23e7"),n=r("d039"),a=r("fc6a"),i=r("06cf").f,o=r("83ab"),c=n((function(){i(1)})),l=!o||c;s({target:"Object",stat:!0,forced:l,sham:!o},{getOwnPropertyDescriptor:function(t,e){return i(a(t),e)}})},f46c:function(t,e,r){"use strict";r("3a61")}}]);
//# sourceMappingURL=chunk-6db8c218.82ded7a0.js.map