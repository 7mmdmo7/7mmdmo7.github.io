(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4a881a90"],{"0cb2":function(e,t,r){var n=r("7b0b"),a=Math.floor,i="".replace,s=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,o=/\$([$&'`]|\d{1,2})/g;e.exports=function(e,t,r,c,l,u){var p=r+e.length,d=c.length,h=o;return void 0!==l&&(l=n(l),h=s),i.call(u,h,(function(n,i){var s;switch(i.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,r);case"'":return t.slice(p);case"<":s=l[i.slice(1,-1)];break;default:var o=+i;if(0===o)return n;if(o>d){var u=a(o/10);return 0===u?n:u<=d?void 0===c[u-1]?i.charAt(1):c[u-1]+i.charAt(1):n}s=c[o-1]}return void 0===s?"":s}))}},"107c":function(e,t,r){var n=r("d039"),a=r("da84"),i=a.RegExp;e.exports=n((function(){var e=i("(?<a>b)","g");return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")}))},"14c3":function(e,t,r){var n=r("825a"),a=r("1626"),i=r("c6b6"),s=r("9263");e.exports=function(e,t){var r=e.exec;if(a(r)){var o=r.call(e,t);return null!==o&&n(o),o}if("RegExp"===i(e))return s.call(e,t);throw TypeError("RegExp#exec called on incompatible receiver")}},3691:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container p-4"},[r("form",{on:{submit:function(t){return t.preventDefault(),e.submit.apply(null,arguments)}}},[r("div",{staticClass:"card m-4"},[r("div",{staticClass:"card-header"},[r("h3",{staticClass:"h3 m-0 text-center"},[e._v(e._s(e.title))])]),r("div",{staticClass:"card-body"},[0==e.status.phone?r("div",{staticClass:"text-center"},[e._m(0),0==e.status.recaptcha_verified?r("div",[e._m(1),r("br"),e._v("Vérifier que vous n'êtes pas un robot ... ")]):e._e()]):e._e(),1==e.status.recaptcha_verified?r("div",{staticClass:"mt-4"},[r("div",{staticClass:"form-group py-1"},[r("label",{attrs:{for:"input-live"}},[e._v("Téléphone *:")]),r("div",{staticClass:"input-group mb-2"},[e._m(2),r("input",{directives:[{name:"model",rawName:"v-model",value:e.phone,expression:"phone"}],staticClass:"form-control",attrs:{type:"tel",pattern:"[0-9]{9}",placeholder:"Receiver phone *",required:"",disabled:e.status.phone},domProps:{value:e.phone},on:{input:function(t){t.target.composing||(e.phone=t.target.value)}}})])]),r("div",{staticClass:"form-group py-1"},[r("label",{attrs:{for:"input-live"}},[e._v("Code OTP (SMS) *:")]),r("input",{directives:[{name:"model",rawName:"v-model",value:e.otp,expression:"otp"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Code OTP (SMS) *",autocomplete:"",disabled:!e.status.phone},domProps:{value:e.otp},on:{input:function(t){t.target.composing||(e.otp=t.target.value)}}})])]):e._e()]),e.errorMessage?r("div",{staticClass:"card-body text-center text-warning"},[e._v(" "+e._s(e.errorMessage)+" "),r("hr"),r("button",{staticClass:"btn btn-block btn-warning",attrs:{type:"button"},on:{click:e.tray_again}},[e._v("Réessayer")])]):e.isLoading?r("div",{staticClass:"card-body"},[r("loading-compoenent")],1):r("div",{staticClass:"card-footer"},[r("div",{staticClass:"d-grid gap-2"},[1==e.status.recaptcha_verified?r("button",{staticClass:"btn btn-outline-primary btn-lg",attrs:{type:"submit"}},[r("i",{staticClass:"bi-person me-2"}),e._v(" Suivant ")]):e._e()])])])])])},a=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticStyle:{display:"inline-block"}},[r("div",{attrs:{id:"recaptcha-container"}})])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"text-center m-auto p-4"},[r("div",{staticClass:"spinner-grow me-2",attrs:{role:"status"}},[r("span",{staticClass:"sr-only"})])])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"input-group-prepend"},[r("div",{staticClass:"input-group-text"},[e._v("(+213)")])])}],i=(r("ac1f"),r("53194"),r("f9f2")),s={name:"signInPhoneComponent",components:{},data:function(){return{phone:"",otp:"",type:"",method:"",title:"",status:{recaptcha_rendred:!1,recaptcha_verified:!1,phone:!1,code_otp:!1,user:!1,profile:!1},next_step:"render_recaptcha",errorMessage:null,isLoading:!1}},watch:{$route:function(){this.type_change()},phone:function(e,t){""!=e&&e!=t&&(this.phone=(""+e).replace(/\D/g,""))}},created:function(){this.type_change(),this.prepare_recaptcha_verifier()},methods:{tray_again:function(){this.isLoading=!1,this.errorMessage=null,this.prepare_recaptcha_verifier()},type_change:function(){var e=this.$route.params.type;"driver"==e?(this.method="sign-up",this.type="driver",this.title="Créer compte - Transporteurs"):"user"==e?(this.method="sign-up",this.type="user",this.title="Créer compte - Distributeur"):"admin"==e?(this.method="sign-up",this.type="admin",this.title="Créer compte - Admin"):(this.method="sign-in",this.type="",this.title="Mon Espace"),console.log(this.type,this.method)},prepare_recaptcha_verifier:function(){var e=this;this.phone="793470277",this.otp="123456",this.recaptcha_verified=!1,this.sms_sent=!1,setTimeout((function(){e.next_step="render_recaptcha",e.create_recaptcha_verifier()}),500)},create_recaptcha_verifier:function(){var e=this;this.recaptchaVerifier=new i["b"]("recaptcha-container",{size:"normal",callback:function(t){console.log("create_recaptcha_verifier - callback",t),e.status.recaptcha_verified=!0,e.next_step="get_phone"},"expired-callback":function(){console.log("create_recaptcha_verifier - expired-callback"),e.status.recaptcha_verified=!1}}),this.recaptchaVerifier.render().then((function(){console.log("recaptcha rendred!"),e.status.recaptcha_rendred=!0,e.next_step="verify_recaptcha"})).catch((function(t){console.log(".recaptchaVerifier.render : error",t),e.status.recaptcha_rendred=!1}))},submit:function(){event.preventDefault(),"get_phone"==this.next_step&&this.send_sms(),"confirm_otp"==this.next_step&&this.confirm_otp()},send_sms:function(){var e=this;console.log("send_sms"),this.isLoading=!0,this.errorMessage=null;var t="+213"+this.phone;console.log("phone",t),i["c"].signInWithPhoneNumber(t,this.recaptchaVerifier).then((function(t){e.isLoading=!1,e.errorMessage=null,console.log("confirmationResult",t),e.confirmationResult=t,e.status.phone=!0,e.next_step="confirm_otp"})).catch((function(e){console.log("signInWithPhoneNumber : error",e)}))},confirm_otp:function(){var e=this;console.log("confirm_otp"),this.confirmationResult.confirm(this.otp).then((function(t){console.log("result",t),"sign-in"==e.method&&e.load_profile(t.user),"sign-up"==e.method&&e.create_profile(t.user)})).catch((function(e){console.log("confirm_otp : error",e)}))},load_profile:function(e){var t=this;this.isLoading=!0,this.errorMessage=null,i["d"].collection("users").doc(e.phoneNumber).get().then((function(r){if(t.isLoading=!1,t.errorMessage=null,r.exists){t.isLoading=!1,t.errorMessage=null,console.log("Profile successfully loaded!");var n=r.data();t.$store.commit("set_user",e),t.$store.commit("set_profile",n),0==n.profile_edited?t.$router.push({name:"edit-profile",params:{phone:e.phoneNumber}}):t.redirect_sign_in(n)}else t.$swal({title:"Oaps!",text:"Profile could not be found!",icon:"info"}),console.log("Profile could not be found!")})).catch((function(e){t.isLoading=!1,t.errorMessage=e,console.log(e)}))},redirect_sign_in:function(e){"driver"==e.type||"user"==e.type||"admin"==e.type?this.$router.push({name:"packages-index",params:{phone:this.$store.state.profile.phone}}):this.$router.push({name:"home"})},create_profile:function(e){var t=this;this.isLoading=!0,this.errorMessage=null;var r=i["a"].serverTimestamp(),n={phone:e.phoneNumber,displayName:e.phoneNumber,type:this.type,permissions:"",profile_edited:!1,created_at:r,modified_at:r};i["d"].collection("users").doc(e.phoneNumber).set(n,{merge:!0}).then((function(){t.isLoading=!1,t.errorMessage=null,console.log("Profile successfully created!"),t.load_profile(e)})).catch((function(e){t.isLoading=!1,t.errorMessage=e,console.log("error",e)}))}}},o=s,c=r("2877"),l=Object(c["a"])(o,n,a,!1,null,"295b6d13",null);t["default"]=l.exports},53194:function(e,t,r){"use strict";var n=r("d784"),a=r("d039"),i=r("825a"),s=r("1626"),o=r("5926"),c=r("50c4"),l=r("577e"),u=r("1d80"),p=r("8aa5"),d=r("dc4a"),h=r("0cb2"),f=r("14c3"),v=r("b622"),g=v("replace"),m=Math.max,_=Math.min,x=function(e){return void 0===e?e:String(e)},b=function(){return"$0"==="a".replace(/./,"$0")}(),y=function(){return!!/./[g]&&""===/./[g]("a","$0")}(),C=!a((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}));n("replace",(function(e,t,r){var n=y?"$":"$0";return[function(e,r){var n=u(this),a=void 0==e?void 0:d(e,g);return a?a.call(e,n,r):t.call(l(n),e,r)},function(e,a){var u=i(this),d=l(e);if("string"===typeof a&&-1===a.indexOf(n)&&-1===a.indexOf("$<")){var v=r(t,u,d,a);if(v.done)return v.value}var g=s(a);g||(a=l(a));var b=u.global;if(b){var y=u.unicode;u.lastIndex=0}var C=[];while(1){var $=f(u,d);if(null===$)break;if(C.push($),!b)break;var E=l($[0]);""===E&&(u.lastIndex=p(d,c(u.lastIndex),y))}for(var I="",R=0,w=0;w<C.length;w++){$=C[w];for(var M=l($[0]),k=m(_(o($.index),d.length),0),P=[],N=1;N<$.length;N++)P.push(x($[N]));var L=$.groups;if(g){var O=[M].concat(P,k,d);void 0!==L&&O.push(L);var S=l(a.apply(void 0,O))}else S=h(M,d,k,P,L,a);k>=R&&(I+=d.slice(R,k)+S,R=k+M.length)}return I+d.slice(R)}]}),!C||!b||y)},"8aa5":function(e,t,r){"use strict";var n=r("6547").charAt;e.exports=function(e,t,r){return t+(r?n(e,t).length:1)}},9263:function(e,t,r){"use strict";var n=r("577e"),a=r("ad6d"),i=r("9f7f"),s=r("5692"),o=r("7c73"),c=r("69f3").get,l=r("fce3"),u=r("107c"),p=RegExp.prototype.exec,d=s("native-string-replace",String.prototype.replace),h=p,f=function(){var e=/a/,t=/b*/g;return p.call(e,"a"),p.call(t,"a"),0!==e.lastIndex||0!==t.lastIndex}(),v=i.UNSUPPORTED_Y||i.BROKEN_CARET,g=void 0!==/()??/.exec("")[1],m=f||g||v||l||u;m&&(h=function(e){var t,r,i,s,l,u,m,_=this,x=c(_),b=n(e),y=x.raw;if(y)return y.lastIndex=_.lastIndex,t=h.call(y,b),_.lastIndex=y.lastIndex,t;var C=x.groups,$=v&&_.sticky,E=a.call(_),I=_.source,R=0,w=b;if($&&(E=E.replace("y",""),-1===E.indexOf("g")&&(E+="g"),w=b.slice(_.lastIndex),_.lastIndex>0&&(!_.multiline||_.multiline&&"\n"!==b.charAt(_.lastIndex-1))&&(I="(?: "+I+")",w=" "+w,R++),r=new RegExp("^(?:"+I+")",E)),g&&(r=new RegExp("^"+I+"$(?!\\s)",E)),f&&(i=_.lastIndex),s=p.call($?r:_,w),$?s?(s.input=s.input.slice(R),s[0]=s[0].slice(R),s.index=_.lastIndex,_.lastIndex+=s[0].length):_.lastIndex=0:f&&s&&(_.lastIndex=_.global?s.index+s[0].length:i),g&&s&&s.length>1&&d.call(s[0],r,(function(){for(l=1;l<arguments.length-2;l++)void 0===arguments[l]&&(s[l]=void 0)})),s&&C)for(s.groups=u=o(null),l=0;l<C.length;l++)m=C[l],u[m[0]]=s[m[1]];return s}),e.exports=h},"9f7f":function(e,t,r){var n=r("d039"),a=r("da84"),i=a.RegExp;t.UNSUPPORTED_Y=n((function(){var e=i("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),t.BROKEN_CARET=n((function(){var e=i("^r","gy");return e.lastIndex=2,null!=e.exec("str")}))},ac1f:function(e,t,r){"use strict";var n=r("23e7"),a=r("9263");n({target:"RegExp",proto:!0,forced:/./.exec!==a},{exec:a})},ad6d:function(e,t,r){"use strict";var n=r("825a");e.exports=function(){var e=n(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},d784:function(e,t,r){"use strict";r("ac1f");var n=r("6eeb"),a=r("9263"),i=r("d039"),s=r("b622"),o=r("9112"),c=s("species"),l=RegExp.prototype;e.exports=function(e,t,r,u){var p=s(e),d=!i((function(){var t={};return t[p]=function(){return 7},7!=""[e](t)})),h=d&&!i((function(){var t=!1,r=/a/;return"split"===e&&(r={},r.constructor={},r.constructor[c]=function(){return r},r.flags="",r[p]=/./[p]),r.exec=function(){return t=!0,null},r[p](""),!t}));if(!d||!h||r){var f=/./[p],v=t(p,""[e],(function(e,t,r,n,i){var s=t.exec;return s===a||s===l.exec?d&&!i?{done:!0,value:f.call(t,r,n)}:{done:!0,value:e.call(r,t,n)}:{done:!1}}));n(String.prototype,e,v[0]),n(l,p,v[1])}u&&o(l[p],"sham",!0)}},fce3:function(e,t,r){var n=r("d039"),a=r("da84"),i=a.RegExp;e.exports=n((function(){var e=i(".","s");return!(e.dotAll&&e.exec("\n")&&"s"===e.flags)}))}}]);
//# sourceMappingURL=chunk-4a881a90.7c0e8b3f.js.map